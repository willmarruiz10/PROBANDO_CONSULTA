<!DOCTYPE html>
<html>
<head>
    <title>Prueba del Sistema</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; }
        button { padding: 10px 15px; margin: 10px; background: #4285f4; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #3367d6; }
        #resultado { background: #f5f5f5; padding: 15px; margin-top: 20px; border-radius: 4px; white-space: pre-wrap; min-height: 100px; }
        .loading { color: #666; font-style: italic; }
        .success { color: #0a0; }
        .error { color: #a00; }
    </style>
</head>
<body>
    <h1>üîß Prueba del Sistema de Consulta</h1>
    <p>Prueba de conexi√≥n con Google Apps Script</p>
    
    <button onclick="probarBackend()">1. Probar Backend</button>
    <button onclick="obtenerDatos()">2. Obtener Datos P√∫blicos</button>
    
    <div id="resultado">Haga clic en un bot√≥n para comenzar...</div>

    <script>
        // REEMPLACE ESTA URL CON LA NUEVA URL DE SU APPS SCRIPT
        const URL_BACKEND = "https://script.google.com/macros/s/AKfycbzkazs1zCA80_-FmQE3Si4Kks-ZwlXwHe7Vz3iJCGrxvbRk2I9sFMF1e5fNpYvarZXChw/exec";
        
        function mostrarResultado(mensaje, tipo = 'info') {
            const resultado = document.getElementById('resultado');
            resultado.textContent = mensaje;
            resultado.className = tipo;
        }
        
        async function probarBackend() {
            mostrarResultado('Probando conexi√≥n con el backend...', 'loading');
            
            try {
                const respuesta = await fetch(URL_BACKEND + "?action=holaMundo");
                const datos = await respuesta.json();
                
                if (datos.success) {
                    mostrarResultado(JSON.stringify(datos, null, 2), 'success');
                } else {
                    mostrarResultado('Error en el backend: ' + datos.message, 'error');
                }
            } catch (error) {
                mostrarResultado('Error de conexi√≥n: ' + error.message + '\n\nPosible soluci√≥n: Verifique la URL del backend y los permisos CORS.', 'error');
            }
        }
        
        async function obtenerDatos() {
            mostrarResultado('Solicitando datos p√∫blicos...', 'loading');
            
            try {
                const respuesta = await fetch(URL_BACKEND + "?action=obtenerDatosPublicos");
                const datos = await respuesta.json();
                
                if (datos.success) {
                    let mensaje = `‚úì ${datos.message}\n`;
                    mensaje += `üìä Total de registros: ${datos.totalRegistros}\n\n`;
                    mensaje += `Encabezados: ${JSON.stringify(datos.encabezados)}\n\n`;
                    mensaje += `Datos: ${JSON.stringify(datos.data, null, 2)}`;
                    
                    mostrarResultado(mensaje, 'success');
                } else {
                    mostrarResultado('Error al obtener datos: ' + datos.message, 'error');
                }
            } catch (error) {
                mostrarResultado('Error de conexi√≥n: ' + error.message, 'error');
            }
        }
        
        // Probemos autom√°ticamente al cargar la p√°gina
        window.addEventListener('load', probarBackend);
    </script>
</body>
</html>
